(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e9c5dd2"],{"41a7":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"d-getsm"},[s("van-pull-refresh",{attrs:{disabled:e.isDis},on:{refresh:e.onRefresh},model:{value:e.isLoading,callback:function(t){e.isLoading=t},expression:"isLoading"}},[s("div",{attrs:{id:"d-content-scroll"}},[s("div",{staticStyle:{"padding-bottom":"50px"}},e._l(e.messageList,(function(t){return s("div",[null!==t.pid?s("div",{staticStyle:{"margin-top":"14px"}},[s("div",{staticStyle:{display:"flex","font-size":"12px",color:"#333"}},[s("div",{staticStyle:{flex:"1","max-width":"55px","max-height":"30px"}},[s("img",{staticStyle:{"max-width":"30px","border-radius":"50%",overflow:"hidden",margin:"0 10px 0 15px"},attrs:{src:e.store_logo}})]),s("div",{staticStyle:{flex:"1","padding-right":"45px"}},[s("div",{staticStyle:{background:"#fff",display:"inline-block",padding:"3px 11px 3px 9px","border-radius":"4px"}},[s("span",{staticStyle:{"line-height":"24px"}},[e._v("\n                                 "+e._s(t.content)+"\n                             ")])])])])]):e._e(),null==t.pid?s("div",{staticStyle:{"margin-top":"14px",float:"right"}},[s("div",{staticStyle:{display:"flex","font-size":"12px",color:"#333"}},[s("div",{staticStyle:{flex:"1","padding-left":"45px"}},[s("div",{staticStyle:{background:"#fff",display:"inline-block",padding:"3px 11px 3px 9px","border-radius":"4px"}},[s("span",{staticStyle:{"line-height":"24px",float:"right"}},[e._v("\n                                 "+e._s(t.content)+"\n                             ")])])]),s("div",{staticStyle:{flex:"1","max-width":"55px","max-height":"30px"}},[s("img",{staticStyle:{"max-width":"30px","border-radius":"50%",overflow:"hidden",margin:"0 10px 0 15px"},attrs:{src:e.user_photo}})])])]):e._e(),s("div",{staticStyle:{clear:"both"}})])})),0)])]),s("div",{staticStyle:{position:"fixed",bottom:"0",width:"100%"}},[s("div",{staticStyle:{display:"flex",padding:"6px 15px 4px 0",background:"#fff"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.sendMessage,expression:"sendMessage"}],staticStyle:{flex:"1",margin:"0 15px",background:"#efefef",border:"none",height:"30px",padding:"0 10px","font-size":"14px",color:"#333","border-radius":"4px"},attrs:{type:"text"},domProps:{value:e.sendMessage},on:{input:function(t){t.target.composing||(e.sendMessage=t.target.value)}}}),s("div",{staticStyle:{flex:"1","max-width":"45px","line-height":"30px","font-size":"14px",color:"#333",background:"#EFEFEF","border-radius":"4px"},on:{click:e.getList}},[s("div",{staticStyle:{height:"30px","text-align":"center"}},[e._v("发送")])])])])],1)},a=[],n=(s("c5f6"),s("7f36")),o=s.n(n),r=s("760b"),d=s.n(r),g=s("2b0e"),l=s("b970");g["default"].use(l["i"]);var c={data:function(){return{isDis:!1,list:[],sendMessage:"",setInter:null,messageList:[],count:0,isLoading:!1,store_logo:"",user_photo:""}},methods:{onRefresh:function(){var e=this;sessionStorage.getItem("message")&&(this.messageList=JSON.parse(sessionStorage.getItem("message")),this.$axios.post("message/getsm",{store_id:this.$route.query.store_id,id:this.messageList[0].id}).then((function(t){e.isLoading=!1;if(t.data.data.msg.length||(e.isDis=!0),t.data.data.msg&&t.data.data.msg.length>0)for(var s in t.data.data.msg)e.messageList.unshift(t.data.data.msg[s]);sessionStorage.setItem("message",JSON.stringify(e.messageList))})))},randomNum:function(e,t){switch(arguments.length){case 1:return parseInt(Math.random()*e+1,10);case 2:return parseInt(Math.random()*(t-e+1)+e,10);default:return 0}},getList:function(){var e=this,t=this.randomNum(1e3,9999)+""+this.randomNum(1e3,9999);this.$axios.post("message/sendsm",{store_id:this.$route.query.store_id,uuid:t,content:this.sendMessage}).then((function(s){Object(l["i"])(s.data.msg);document.getElementById("d-content-scroll");var i={content:e.sendMessage,uuid:t,pid:null};e.messageList.push(i),sessionStorage.setItem("message",JSON.stringify(e.messageList)),e.sendMessage="",setTimeout((function(){var e=document.querySelector("#d-content-scroll");e&&(e.scrollTop=e.scrollHeight-e.clientHeight)}),1e3)}))},getMessage:function(){var e=this;sessionStorage.getItem("message")?(this.messageList=JSON.parse(sessionStorage.getItem("message")),this.$axios.post("message/getsm",{store_id:this.$route.query.store_id}).then((function(t){e.store_logo=t.data.data.store_logo||d.a,e.user_photo=t.data.data.user_photo||o.a;var s=JSON.parse(sessionStorage.getItem("message")),i=s.map((function(e){return e.uuid})),a=t.data.data.msg.map((function(e){return e.uuid}));for(var n in a){var r=a[n];if(i.indexOf(r)>-1);else if(a.indexOf(Number(r))){var g=t.data.data.msg[a.indexOf(a[n])];s.push(g)}}(e.messageList.length<=0||e.messageList[e.messageList.length-1].uuid!=t.data.data.msg[0].uuid)&&setTimeout((function(){var e=document.querySelector("#d-content-scroll");e&&(e.scrollTop=e.scrollHeight-e.clientHeight)}),2e3),sessionStorage.setItem("message",JSON.stringify(s))}))):this.$axios.post("message/getsm",{store_id:this.$route.query.store_id}).then((function(t){(e.messageList.length<=0||e.messageList[e.messageList.length-1].uuid!=t.data.data.msg[0].uuid)&&setTimeout((function(){var e=document.querySelector("#d-content-scroll");e&&(e.scrollTop=e.scrollHeight-e.clientHeight)}),2e3),e.messageList=t.data.data.msg.reverse(),sessionStorage.setItem("message",JSON.stringify(t.data.data.msg))}))}},mounted:function(){var e=this;this.setInter=setInterval((function(){e.getMessage()}),2e3);var t=document.querySelector("#d-content-scroll");t&&setTimeout((function(){t.scrollTop=t.scrollHeight-t.clientHeight}),3e3)},destroyed:function(){clearInterval(this.setInter),sessionStorage.removeItem("message")}},u=c,m=(s("bbde"),s("2877")),p=Object(m["a"])(u,i,a,!1,null,"cf52f41e",null);t["default"]=p.exports},"4de1":function(e,t,s){},"760b":function(e,t,s){e.exports=s.p+"img/infor3.f54fb5c9.png"},"7f36":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAA7VBMVEVHcEzYHQX05ynYHAXZHQTVHQXYGwTbSQrYHQXYHQXYHQXYHQXZIwTz4SfYHQT06in019YCAQHZGwSxpKXcy8zHtLPvxMLXGwDYHAWek5MrKys3MC/y2ib06yn06Sr06in16ikrKCmLdXMcHBzz6SjYHgb06ir86eosLCwAAAD2FCv+/v7YHQXvlI7z3SfcPAraKQzywybsdW7rjh/zNTJ1IRY1CQRXJiH0vrn5zs7qnxuWGws9LCncNyLoQyrjXUz99PIYBgRPCgH33t7vySPxr6i2IA2wFwRnSET0FilZDAImHBuxlZTwbCTwbyQZbcdsAAAAJXRSTlMA6v2eg/0/C/Xds81PTXni/vk16+33+iJs7f7z6XGNwLPt/fBn829hFQAAAhhJREFUOMt1lWl7ojAQxwMFRAVvH9vtuUcIIpeggrZqW3W3e37/j7MBEpII/l/4BObHzCSZGQEQpCmttqTrUrulaOCiGp0m5NTsNOoxRYdn0pUaVGvCilTYrCSgUOOP5fsqSZbf6bMiclcUW02xbKyEolc1nPprOqWgbS+rJImrrgrurQDtRC3ed8p9kE/fC276m4DUpzog51Ls130mXN8u9UxOtCEEfiPgVwa+8MEbuujw8/BTxaWUueyIGfZH6IaRdOfXGCQ34pItDxFC41sKJgRsAzChV5Cn2L9BmXpfXkiS1DoB13SZebwdI6LDn4+M/YBlbHp58DQejpCg3uhwguX1tMnK9VCNPFgmKdHlvg7cU6sEWLX2qtya1TBQy3VUBSNWwyw0hOk5lzKbBLgO2B7OAm+5TgMtrkV2a5Fzma3FmiVTyJ2RF7ocqABDbLydl28+jbaQ56BBq4ycuhvuo1Oaet7+rMNxnXFJukGMZkSvcQD5FFnH4Axj2VpErzkWLSw5DrnIWPS2g6Nl+Y6zWM9m64Xj+JZ1DFg5Yg0Ihy3W3MHyvOx3jh99Qmpc+4cZV4Bx/JOA8jGkGZb9usm4PDQm5ji0nL/YZNc3oRNgoMPAKrT7lwPy3x15EUCVm2iavrEuaKMa/JQy/Eugb4hzz7yr5+7Mysi971ax7n3tEP/2JPOU/GRe/l8wHx6xY7nbfXwwxUH/HyRivQJqLnXNAAAAAElFTkSuQmCC"},bbde:function(e,t,s){"use strict";var i=s("4de1"),a=s.n(i);a.a}}]);