(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3598ba50"],{"3f3f":function(t,e,s){"use strict";var a=s("813b"),i=s.n(a);i.a},"41a7":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[s("div",{attrs:{id:"d-content-scroll"}},[s("div",{staticStyle:{"padding-bottom":"50px"}},t._l(t.messageList,function(e){return s("div",[null!==e.pid?s("div",{staticStyle:{"margin-top":"14px"}},[s("div",{staticStyle:{display:"flex","font-size":"12px",color:"#333"}},[s("div",{staticStyle:{flex:"1","max-width":"55px","max-height":"30px"}},[s("img",{staticStyle:{"max-width":"30px","border-radius":"50%",overflow:"hidden",margin:"0 10px 0 15px"},attrs:{src:t.store_logo}})]),s("div",{staticStyle:{flex:"1","padding-right":"45px"}},[s("div",{staticStyle:{background:"#fff",display:"inline-block",padding:"3px 11px 3px 9px","border-radius":"4px"}},[s("span",{staticStyle:{"line-height":"24px"}},[t._v("\n                                 "+t._s(e.content)+"\n                             ")])])])])]):t._e(),null==e.pid?s("div",{staticStyle:{"margin-top":"14px",float:"right"}},[s("div",{staticStyle:{display:"flex","font-size":"12px",color:"#333"}},[s("div",{staticStyle:{flex:"1","padding-left":"45px"}},[s("div",{staticStyle:{background:"#fff",display:"inline-block",padding:"3px 11px 3px 9px","border-radius":"4px"}},[s("span",{staticStyle:{"line-height":"24px",float:"right"}},[t._v("\n                                 "+t._s(e.content)+"\n                             ")])])]),s("div",{staticStyle:{flex:"1","max-width":"55px","max-height":"30px"}},[s("img",{staticStyle:{"max-width":"30px","border-radius":"50%",overflow:"hidden",margin:"0 10px 0 15px"},attrs:{src:t.user_photo}})])])]):t._e(),s("div",{staticStyle:{clear:"both"}})])}),0)])]),s("div",{staticStyle:{position:"fixed",bottom:"0",width:"100%"}},[s("div",{staticStyle:{display:"flex",padding:"6px 15px 4px 0",background:"#fff"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.sendMessage,expression:"sendMessage"}],staticStyle:{flex:"1",margin:"0 15px",background:"#efefef",border:"none",height:"30px",padding:"0 10px","font-size":"14px",color:"#333","border-radius":"4px"},attrs:{type:"text"},domProps:{value:t.sendMessage},on:{input:function(e){e.target.composing||(t.sendMessage=e.target.value)}}}),s("div",{staticStyle:{flex:"1","max-width":"45px","line-height":"30px","font-size":"14px",color:"#333",background:"#EFEFEF","border-radius":"4px"},on:{click:t.getList}},[s("div",{staticStyle:{height:"30px","text-align":"center"}},[t._v("发送")])])])])],1)},i=[],n=(s("c5f6"),s("2b0e")),o=s("b970");n["default"].use(o["h"]);var r={data:function(){return{list:[],sendMessage:"",setInter:null,messageList:[],count:0,isLoading:!1,store_logo:"",user_photo:""}},methods:{onRefresh:function(){var t=this;localStorage.getItem("message")&&(this.messageList=JSON.parse(localStorage.getItem("message")),this.$axios.post("message/getsm",{store_id:this.$route.query.store_id,id:this.messageList[0].id}).then(function(e){t.isLoading=!1;for(var s in e.data.data.msg)t.messageList.unshift(e.data.data.msg[s]);localStorage.setItem("message",JSON.stringify(t.messageList))}))},randomNum:function(t,e){switch(arguments.length){case 1:return parseInt(Math.random()*t+1,10);case 2:return parseInt(Math.random()*(e-t+1)+t,10);default:return 0}},getList:function(){var t=this,e=this.randomNum(1e3,9999)+""+this.randomNum(1e3,9999);this.$axios.post("message/sendsm",{store_id:this.$route.query.store_id,uuid:e,content:this.sendMessage}).then(function(s){Object(o["h"])(s.data.msg);document.getElementById("d-content-scroll");var a={content:t.sendMessage,uuid:e,pid:null};t.messageList.push(a),localStorage.setItem("message",JSON.stringify(t.messageList)),t.sendMessage=""})},getMessage:function(){var t=this;localStorage.getItem("message")?(this.messageList=JSON.parse(localStorage.getItem("message")),this.$axios.post("message/getsm",{store_id:this.$route.query.store_id}).then(function(e){t.store_logo=e.data.data.store_logo,t.user_photo=e.data.data.user_photo;var s=JSON.parse(localStorage.getItem("message")),a=s.map(function(t){return t.uuid}),i=e.data.data.msg.map(function(t){return t.uuid});for(var n in i){var o=i[n];if(a.indexOf(o)>-1);else if(i.indexOf(Number(o))){var r=e.data.data.msg[i.indexOf(i[n])];s.push(r)}}localStorage.setItem("message",JSON.stringify(s))})):this.$axios.post("message/getsm",{store_id:this.$route.query.store_id}).then(function(e){t.messageList=e.data.data.msg.reverse(),localStorage.setItem("message",JSON.stringify(e.data.data.msg))})}},mounted:function(){var t=this;document.querySelector("body").setAttribute("style","background-color:#f5f5f5"),this.setInter=setInterval(function(){t.getMessage()},2e3)},destroyed:function(){clearInterval(this.setInter),localStorage.removeItem("message")}},d=r,l=(s("3f3f"),s("2877")),g=Object(l["a"])(d,a,i,!1,null,"280f8118",null);e["default"]=g.exports},"813b":function(t,e,s){}}]);
//# sourceMappingURL=chunk-3598ba50.7660702f.js.map